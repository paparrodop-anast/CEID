%??????????? ??????????? ??? ??? ??????? ?????
z = [1:20];
p = poly(z);
%?????? ??????? ??????????
e = [10^(-8) (-10^3) 10^10] ; 
e_all = [10^(-8)];
e_all_rel = p*(2^(-52));
%???????????? ??? ?????????? g ??? ????????????? ??? ??????????? ??? ??
%????????????
g = zeros(5,21);
g(1,2) = 1;
g(2,10) = 1;
g(3,20) = 1;
g(4,2:21) = 1;
g(5,2:21) = 1;
%???????????? ??? ?????????? f ??? ??????????? ??? ???? ???????????
f = zeros(5,21);
f(1,:) = p + g(1,:).*e(1); 
f(2,:) = p + g(2,:).*e(2);
f(3,:) = p + g(3,:).*e(3);
f(4,:) = p + g(4,:).*e_all;
f(5,:) = p + g(5,:).*e_all_rel;
%?? ????? ??? ?????????? ???? ??? ??????????
new_roots = zeros(5,20);
new_roots(1,:) = roots(f(1,:));
new_roots(2,:) = roots(f(2,:));
new_roots(3,:) = roots(f(3,:));
new_roots(4,:) = roots(f(4,:));
new_roots(5,:) = roots(f(5,:));
%??????????? ????? ?????????? ?? ??????????? ??? ???????????
relative_error = zeros(5,20);
first_roots = zeros(5,20);
for i=1:5
   if (isreal(new_roots(i,:)) == 1)
       for j=1:20
           [diff, posi] = min(abs(new_roots(i,j)-z));
           relative_error(i,j) = abs(new_roots(i,j)- posi)/abs(posi);
           first_roots(i,j) = posi;
       end
   else
       new_roots(i,:) = sort(new_roots(i,:), 'ascend');
       for j=1:20
           relative_error(i,j) = abs(new_roots(i,j)- z(j))/abs(z(j));
           first_roots(i,j) = z(j);
       end
   end
end
%???????? ???????? ??? ?????????????? ??? ??????? ????? ??? ???????? ???????
for i=1:5
    [S,I] = sort(relative_error(i,:), 'descend');
    relative_error(i,:) = S;
    new_roots(i,:) = new_roots(i,I);
    first_roots(i,:) = first_roots(i,I); 
end
%??????? ??? ??? ????? ?????????
figure
plot(real(new_roots(1,:)),imag(new_roots(1,:)),'rx','MarkerSize',8);
hold on;
plot(real(first_roots(1,:)),zeros(1,20),'bo','MarkerSize',8);
hold off; grid on; 
title('f(1)'); xlabel('real'); ylabel('imag');
legend('new roots','first roots','Location','Best'); 
%??????? ??? ??? ??????? ?????????
figure
plot(real(new_roots(2,:)),imag(new_roots(2,:)),'rx','MarkerSize',8);
hold on;
plot(real(first_roots(2,:)),zeros(1,20),'bo','MarkerSize',8);
hold off; grid on; 
title('f(2)'); xlabel('real'); ylabel('imag');
legend('new roots','first roots','Location','Best'); 
%??????? ??? ??? ????? ?????????
figure
plot(real(new_roots(3,:)),imag(new_roots(3,:)),'rx','MarkerSize',8);
hold on;
plot(real(first_roots(3,:)),zeros(1,20),'bo','MarkerSize',8);
hold off; grid on; 
title('f(3)'); xlabel('real'); ylabel('imag');
legend('new roots','first roots','Location','Best'); 
%??????? ??? ??? ??????? ?????????
figure
plot(real(new_roots(4,:)),imag(new_roots(4,:)),'rx','MarkerSize',8);
hold on;
plot(real(first_roots(4,:)),zeros(1,20),'bo','MarkerSize',8);
hold off; grid on; 
title('f(4)'); xlabel('real'); ylabel('imag');
legend('new roots','first roots','Location','Best'); 
%??????? ??? ??? ?????? ?????????
figure
plot(real(new_roots(5,:)),imag(new_roots(5,:)),'rx','MarkerSize',8);
hold on;
plot(real(first_roots(5,:)),zeros(1,20),'bo','MarkerSize',8);
hold off; grid on; 
title('f(5)'); xlabel('real'); ylabel('imag');
legend('new roots','first roots','Location','Best'); 